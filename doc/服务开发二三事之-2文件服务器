草稿

1. 极速上传，也叫秒传
秒传的深层次技术实际上叫‘重删’，就是说有相同份相同的数据，只存储其中一份，其他的重复数据块只保留一个
地址映射。
秒传的优点：
    1. 提高用户体验。
    2. 减少存储浪费。
    3. 减少上传网路带宽占用。
缺点：
    1. 极小的概略会发生碰撞，导致用户数据丢失
    2. 隐私不能得到保证。当用户删除文件的时候，文件未必真的被删除。

做法，用户在上传文件的时候，需要先提取文件特征值，一般采用SHA1,SHA2。由于MD5的碰撞率问题，MD5一般不使用。
提取特征值后，会上传到服务器进行对比，以决定是否上传。如果服务器已经有响应的文件，则返回url即可。否则，需要上传。
对于大文件，通常会切割成比较小的块来计算的。

2. 加密上传
这里加密指的是客户的加密，一般采用AES，密钥会通过其他途经发给接收者，对于IM来说，一般密钥和url都是放到消息体的。
优点：
    1. 数据足够安全，只要文件和密钥不是同时被获取到，很难解开文件内容
    2. 文件可以存储在任何地方，哪怕第三方服务器。
缺点：
    1. 效率比较低，不再能够进行秒传
    2. 由于服务器无法解析文件，因此，像文件预览这种功能都是没法实现的。
    3. 对于图片类的文件，需要由客户端来做一些文件的操作，比如缩图。

3. 断点上传、断点下载
    断点的主要目的，是当文件过大，网络不稳定的时候，能够给用户更好的上传下载体验。
    做法就是将文件进行分片，然后上传和下载。

4. 协议
    目前一般采用http/https传输，接口符合RESTAPI标准

5. 协议加速
    1) 采用HTTP2.0 并发上传下载
    2) 数据进行压缩(比如gzip,lzip等等)。
    3) kuptun  
    
文件服务器架构和技术

    